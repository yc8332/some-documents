### TCP/IP四层模型
![](http://wx3.sinaimg.cn/large/abf82c72ly1fnwcky5v3hj208m04z74g.jpg)
- 应用层：负责处理特定的应用程序细节
- 运输层：为两台主机上的应用程序提供端到端的通信   
    `TCP`(传输控制协议)和`UDP`(用户数据报协议)。TCP为两台主机提供高可靠的数据通信，它所做的工作包括把应用程序交给它的数据分成合适的小块交给下面的网络层，确认收到的分组，设置发送最后确认分组的超时时钟等。
- 网络层：处理分组在网络中的活动，如分组的选路   
    网络层协议包括IP(网际协议)，ICMP(Internet互联网控制报文协议)，IGMP(Internet组管理协议)。其中IP提供一种不可靠的服务，只负责将分组从源节点尽可能快地送到目的节点，可靠性由上面的运输层TCP来保证。
- 链路层：处理与传输介质的物理接口细节

### 封装
当应用程序用TCP传送数据时，数据由上往下通过每一层直到最后当作一串比特流送入网络，这个过程称为封装(其实就是对上一层传下来的数据加上自己层的报文首部进行打包)。
- TCP传给IP的数据单元称为TCP报文段，UDP传给IP的数据单元称为UDP数据报。
- IP传给网络接口层的数据单元称为IP数据报。
- 网络接口层传给物理层的比特流称为帧。
![](http://wx1.sinaimg.cn/large/abf82c72ly1fnwdhfpvndj20gy0c1aax.jpg)

### 分用
当目标主机收到一个数据帧时，数据从协议栈由底向上升，同时去掉各层协议加上的报文首部。检查报文首部的协议标识，将数据传到上层的正确协议(其实就是对下一层传上来的数据拆包并正确地转发)。   
其中，数据从TCP或UDP向应用层分用是根据端口号来区分不同程序的。
